<div th:fragment="content">
    <main class="main-content notice-board">
        <div class="board-head">
            <h2 class="board-title">
                ê³µì§€ì‚¬í•­ <span class="badge-pill">NOTICE</span>
                <small class="sub">ì´ë²¤íŠ¸ / ì—…ë°ì´íŠ¸ ì•ˆë‚´</small>
            </h2>

            <!-- ê²€ìƒ‰ ì œê±°, ê¸€ì“°ê¸°ë§Œ ìš°ì¸¡ ì •ë ¬ -->

        </div>

        <table id="noticeTable" class="table-notice">
            <thead>
            <tr>
                <th>ë²ˆí˜¸</th>
                <th>ì œëª©</th>
                <th>ë“±ë¡ì¼</th>
            </tr>
            </thead>
            <tbody>
            <!-- JSë¡œ ëª©ë¡ ì‚½ì… -->
            <!-- í•„ìš” ì‹œ tr ì— data-created-at / data-has-file / data-preview ì‚¬ìš©
                 ì˜ˆ) <tr data-created-at="2025-09-29T11:02:00" data-has-file="true" data-preview="ë‚´ìš© ì²« ì¤„ ë¯¸ë¦¬ë³´ê¸°"> -->
            </tbody>
        </table>

        <div class="empty-state" id="noticeEmpty" hidden>
            <div class="icon">ğŸ—’ï¸</div>
            <p>ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>

        <div class="pagination" id="pagination"></div>
    </main>

    <script th:inline="javascript">
        window.postCategory = /*[[${postCategory}]]*/ 'NOTICE';
    </script>

    <!-- ì œëª© ì…€ ìë™ ê¾¸ë¯¸ê¸°: ëª©ë¡ ë Œë” í›„ì—ë„ ìë™ ë°˜ì˜ -->
    <script>
        (function () {
            function enhanceRow(tr) {
                if (tr.dataset.enhanced) return;

                const td = tr.querySelector('td:nth-child(2)');
                if (!td) return;

                // ê¸°ì¡´ ë§í¬ê°€ ìˆìœ¼ë©´ ì¬í™œìš©, ì—†ìœ¼ë©´ ìƒˆë¡œ ë§Œë“ ë‹¤
                let link = td.querySelector('a');
                let href = link?.getAttribute('href') || '#';
                let rawText = (link?.textContent || td.textContent || '').trim();

                // ì œëª© ì…€ êµ¬ì¡° ë®ì–´ì“°ê¸°
                td.classList.add('title-cell');
                td.innerHTML = `
          <div class="title-line">
            <a href="${href}"><span class="title-text"></span></a>
            <span class="badge-new" hidden>NEW</span>
            <span class="arrow">â€º</span>
          </div>
          <span class="title-preview" hidden></span>
        `;
                td.querySelector('.title-text').textContent = rawText;

                // data-* ê¸°ì¤€ìœ¼ë¡œ ë°°ì§€/í”„ë¦¬ë·° í‘œì‹œ
                const hasFile   = tr.dataset.hasFile === 'true';
                const createdAt = tr.dataset.createdAt;
                const preview   = tr.dataset.preview;

                if (hasFile) td.querySelector('.badge-file').hidden = false;

                if (createdAt) {
                    const diff = Date.now() - new Date(createdAt).getTime();
                    const THREE_DAYS = 1000 * 60 * 60 * 24 * 3;
                    if (diff < THREE_DAYS) td.querySelector('.badge-new').hidden = false;
                }

                if (preview) {
                    const pv = td.querySelector('.title-preview');
                    pv.textContent = preview;
                    pv.hidden = false;
                }

                tr.dataset.enhanced = '1';
            }

            function enhanceAll() {
                document
                    .querySelectorAll('.notice-board .table-notice tbody tr')
                    .forEach(enhanceRow);
            }

            // ì´ˆê¸° ì‹¤í–‰
            document.addEventListener('DOMContentLoaded', enhanceAll);

            // ë™ì  ê°±ì‹ ì— ëŒ€ì‘ (ëª©ë¡ì„ ë‹¤ì‹œ ê·¸ë¦¬ë©´ ìë™ ì ìš©)
            const tbody = document.querySelector('.notice-board .table-notice tbody');
            if (tbody && 'MutationObserver' in window) {
                new MutationObserver(enhanceAll).observe(tbody, { childList: true });
            }

            // í•„ìš” ì‹œ ëª©ë¡ ë Œë” ì§í›„ ìˆ˜ë™ í˜¸ì¶œë„ ê°€ëŠ¥
            window.decorateNoticeRows = enhanceAll;
        })();
    </script>
</div>
