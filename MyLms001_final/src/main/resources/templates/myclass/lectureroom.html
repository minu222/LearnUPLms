<!-- src/main/resources/templates/myclass/lectureroom.html -->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ìˆ˜ê°•ëª©ë¡</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700&display=swap');

        :root{
            --accent:#ff9900;   /* ì‚¬ì´íŠ¸ ì˜¤ë Œì§€ ìœ ì§€ */
            --accent-2:#e68a00;
            --bg:#0e0e10;
            --panel:#111214;
            --panel-2:#17181b;
            --line:#232428;
            --text:#e7e7ea;
            --muted:#a8a8b2;
            --green:#22c55e;
            --blue:#3b82f6;
            --pink:#ec4899;
        }

        *{box-sizing:border-box}
        html,body{height:100%}

        .lr-body{
            margin:0;
            font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
            background:
                    radial-gradient(1200px 600px at 10% -10%, rgba(255,153,0,.10), transparent 60%),
                    radial-gradient(900px 600px at 90% 0%, rgba(255,153,0,.06), transparent 60%),
                    var(--bg);
            color:var(--text);
        }

        /* íŒì—…ì¼ ë•Œ í™”ë©´ ê°€ì¥ìë¦¬ ì—¬ë°± */
        .lr-body.is-popup{ padding: 6px 10px 12px; }

        /* ìƒë‹¨ í—¤ë” */
        .lr-header{
            max-width: 1280px; margin: 16px auto 8px;
            display:flex; align-items:center; justify-content:space-between;
            padding: 8px 4px;
            transition: padding .2s ease;
        }
        /* âœ… íŒì—…ì¼ ë•Œ ë‹«ê¸° ë²„íŠ¼ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ìš°ì¸¡ íŒ¨ë”© í™•ë³´ */
        .is-popup .lr-header{ padding-right: 96px; }

        .lr-brand{display:flex; gap:14px; align-items:center;}
        .lr-logo{display:flex; gap:8px; align-items:center;}
        .lr-logo-img{width:32px;height:32px;border-radius:8px;object-fit:cover}
        .lr-logo-text{font-weight:800;color:var(--accent); letter-spacing:.2px}
        .lr-course-meta{display:grid; gap:2px}
        .lr-title{font-size:22px; font-weight:800; margin:0}
        .lr-sub{margin:0; color:var(--muted); font-size:13px}
        .lr-actions{display:flex; gap:8px}
        .lr-ghost{
            background:transparent; color:var(--text); border:1px solid var(--line);
            padding:8px 12px; border-radius:10px; cursor:pointer;
        }
        .lr-ghost:hover{background:#1b1c20}

        /* ë©”ì¸ ê·¸ë¦¬ë“œ */
        .lr-shell{
            max-width:1280px; margin: 0 auto 12px;
            display:grid; grid-template-columns: 1fr 360px; gap:16px;
            padding: 0 4px;
        }
        .sidebar-collapsed .lr-shell{ grid-template-columns: 1fr 0px; }
        .sidebar-collapsed .lr-sidebar{ display:none; }

        /* í”Œë ˆì´ì–´ */
        .lr-player-wrap{
            background:var(--panel);
            border:1px solid var(--line);
            border-radius:14px;
            padding:12px;
            box-shadow: 0 10px 30px rgba(0,0,0,.25);
        }
        .lr-aspect{
            position:relative;
            background:#000;
            border-radius:10px;
            overflow:hidden;
            aspect-ratio: 16 / 9;
        }
        .lr-video{ width:100%; height:100%; display:block; background:#000; }
        .lr-overlay{
            position:absolute; inset:0;
            background: radial-gradient(80% 80% at 50% 50%, rgba(0,0,0,.0), rgba(0,0,0,.35));
            pointer-events:none;
        }

        /* ì»¨íŠ¸ë¡¤ ë°” */
        .lr-controls{
            margin-top:10px;
            display:flex; gap:12px; align-items:center; justify-content:space-between;
        }
        .lr-progress{
            flex:1 1 auto;
            display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:center;
        }
        .lr-progress input[type="range"]{
            width:100%;
            appearance:none; height:6px; border-radius:999px;
            background:linear-gradient(90deg, var(--accent) var(--val,0%), #3a3c44 var(--val,0%));
            outline:none; cursor:pointer;
        }
        .lr-progress input[type="range"]::-webkit-slider-thumb{
            appearance:none; width:14px; height:14px; border-radius:50%; background:#fff; border:2px solid var(--accent);
        }
        .lr-time{font-size:12px; color:var(--muted)}

        .lr-ctrl-right{display:flex; gap:8px; align-items:center}
        .lr-btn{
            background:var(--accent); border:0; color:#111;
            padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700;
        }
        .lr-btn:hover{background:var(--accent-2)}
        .lr-speed{display:flex; gap:6px; align-items:center; color:#muted; font-size:13px}
        .lr-speed select{
            background:#1d1f24; color:#fff; border:1px solid var(--line);
            padding:6px 8px; border-radius:8px;
        }

        /* ì •ë³´ ì¹´ë“œ */
        .lr-info{
            margin-top:10px;
            background:var(--panel-2); border:1px solid var(--line);
            border-radius:12px; padding:10px 12px; color:#d7d7db;
        }
        .lr-muted{color:var(--muted);}

        /* ì‚¬ì´ë“œë°” */
        .lr-sidebar{
            background:var(--panel);
            border:1px solid var(--line);
            border-radius:14px;
            padding:12px;
            display:flex; flex-direction:column; gap:10px;
            box-shadow: 0 8px 24px rgba(0,0,0,.22);
        }
        .lr-tabs{display:flex; gap:6px;}
        .lr-tabs button{
            flex:1 1 0;
            background:#1b1c20; color:#cfcfd6; border:1px solid var(--line);
            padding:10px 12px; border-radius:10px; cursor:pointer; font-weight:700;
        }
        .lr-tabs button.active{ background:var(--accent); color:#111; border-color:transparent; }

        .lr-tabpanel{min-height:380px}

        /* âœ… ë‹¨ì¼ VODìš© â€œê°œìš”â€ íŒ¨ë„ */
        .lr-info-grid{
            display:grid; gap:10px;
        }
        .lr-card{
            background:#15161a; border:1px solid #22242a;
            border-radius:10px; padding:12px;
        }
        .lr-card h4{ margin:0 0 8px; font-size:15px; color:#fff; }
        .lr-def{ display:grid; gap:6px; font-size:14px; color:#dcdce1; }
        .lr-def .row{ display:flex; gap:10px; justify-content:space-between; }
        .lr-def .k{ color:#aeb0b8; }
        .lr-badges{ display:flex; gap:8px; flex-wrap:wrap; }
        .lr-badge{
            display:inline-flex; align-items:center; gap:6px;
            padding:6px 10px; border-radius:999px; font-weight:700; font-size:12px;
            color:#111; background:var(--accent);
        }
        .lr-badge.blue{ background:var(--blue); color:#fff; }
        .lr-badge.pink{ background:var(--pink); color:#fff; }

        .lr-resource{ display:grid; gap:8px; }
        .lr-resource a{
            display:flex; justify-content:space-between; align-items:center;
            background:#13151a; border:1px solid #23262d; padding:10px 12px; border-radius:10px;
            color:#e5e7eb; text-decoration:none;
        }
        .lr-resource a:hover{ border-color:#2b2e36; }

        .lr-quick{ display:flex; gap:8px; flex-wrap:wrap; }
        .lr-quick .lr-ghost{ padding:10px 12px; }

        /* ë©”ëª¨ */
        .lr-note{
            width:100%; height:320px; resize:vertical;
            background:#131419; color:#eaeaf0; border:1px solid #24262c; border-radius:10px;
            padding:10px 12px; line-height:1.6;
        }
        .lr-note-actions{display:flex; gap:8px; margin-top:8px}

        /* ì±„íŒ… */
        .lr-chat{
            height:320px; overflow:auto;
            background:#121317; border:1px solid #24262c; border-radius:10px;
            padding:10px 12px; display:flex; flex-direction:column; gap:8px;
        }
        .lr-chat-msg{
            max-width:80%;
            align-self:flex-end;
            background:var(--accent); color:#111; padding:8px 12px; border-radius:14px 14px 2px 14px;
            font-weight:600;
        }
        .lr-chat-msg.is-system{
            align-self:flex-start; background:#2a2d34; color:#dcdce1; border-radius:12px; font-weight:400;
        }
        .lr-chat-input{display:flex; gap:8px; margin-top:8px}
        .lr-chat-input input{
            flex:1 1 auto; background:#131419; color:#fff; border:1px solid #24262c; border-radius:10px; padding:10px 12px;
        }

        /* í‘¸í„° */
        .lr-footer{
            max-width:1280px; margin: 8px auto 18px; color:#9fa0aa; font-size:12px; padding:0 4px;
        }

        /* ì‹œë„¤ë§ˆ(ê·¹ì¥) ëª¨ë“œ: ë¹„ë””ì˜¤ ë„“ê²Œ */
        .theater .lr-shell{ grid-template-columns: 1.2fr 360px; }

        /* íŒì—… ë‹«ê¸° */
        .lr-close{
            position:fixed; right:14px; top:10px;
            border:1px solid #3a3c44; background:#1b1c20; color:#e7e7ea;
            padding:6px 10px; border-radius:8px; cursor:pointer; z-index:10;
        }
        .lr-close:hover{background:#23252b}

        /* ë°˜ì‘í˜• */
        @media (max-width: 1024px){
            .lr-shell{ grid-template-columns:1fr; }
            .lr-sidebar{ order:2 }
        }
        @media (max-width: 560px){
            .lr-title{font-size:18px}
            .lr-actions{display:none}
            .is-popup .lr-header{ padding-right: 72px; }
        }
    </style>
</head>
<body class="lr-body" th:classappend="${isPopup} ? 'is-popup'">
<div th:fragment="content">

    <!-- íŒì—… ë‹«ê¸° -->
    <button class="lr-close" th:if="${isPopup}" type="button" onclick="window.close()">ì°½ ë‹«ê¸°</button>

    <!-- í—¤ë” -->
    <header class="lr-header">
        <div class="lr-brand">
            <div class="lr-logo">
                <img th:src="@{/images/dw.png}" alt="ë¡œê³ " class="lr-logo-img">
                <span class="lr-logo-text">MyLMS</span>
            </div>
            <div class="lr-course-meta">
                <h1 class="lr-title" th:text="${title != null ? title : 'ê°•ì˜ì‹¤'}">ê°•ì˜ì‹¤</h1>
            </div>
        </div>
        <div class="lr-actions">
            <button class="lr-ghost" type="button" onclick="toggleTheater()">ì‹œë„¤ë§ˆ</button>
            <button class="lr-ghost" type="button" onclick="toggleSidebar()">ì‚¬ì´ë“œ ì ‘ê¸°</button>
        </div>
    </header>

    <!-- ë©”ì¸ ë ˆì´ì•„ì›ƒ -->
    <main class="lr-shell">
        <!-- ì˜ìƒ ì˜ì—­ -->
        <section class="lr-player-wrap" id="playerArea">
            <div class="lr-aspect">
                <video id="player" class="lr-video" controls preload="metadata" playsinline>
                    <source th:if="${videoUrl}" th:src="@{${videoUrl}}" th:type="${videoType}" />
                    ë¸Œë¼ìš°ì €ê°€ HTML5 ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </video>
                <div class="lr-overlay" id="overlay" hidden></div>
            </div>

            <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤/ì§„í–‰ë°” -->
            <div class="lr-controls">
                <div class="lr-progress">
                    <input id="progress" type="range" min="0" max="100" value="0" step="0.1" aria-label="ì§„í–‰ë¥ ">
                    <div class="lr-time">
                        <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                    </div>
                </div>
                <div class="lr-ctrl-right">
                    <label class="lr-speed">
                        ë°°ì†
                        <select id="speed">
                            <option value="0.75">0.75x</option>
                            <option value="1" selected>1.0x</option>
                            <option value="1.25">1.25x</option>
                            <option value="1.5">1.5x</option>
                            <option value="1.75">1.75x</option>
                            <option value="2">2.0x</option>
                        </select>
                    </label>
                    <button type="button" class="lr-btn" onclick="step(-10)">âª 10s</button>
                    <button type="button" class="lr-btn" onclick="step(10)">10s â©</button>
                    <button type="button" class="lr-btn" onclick="toggleFullscreen()">ì „ì²´í™”ë©´</button>
                </div>
            </div>

            <!-- ì½”ìŠ¤ ë©”íƒ€/ì•Œë¦¼ -->
            <div class="lr-info">
                <div><strong>ê°•ì˜ ì œëª©:</strong> <span th:text="${coursetitle}">ì œëª©</span></div>
                <div class="lr-muted" th:if="${videoUrl == null}">
                    ì¬ìƒ ê°€ëŠ¥í•œ ë™ì˜ìƒ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.
                </div>
            </div>
        </section>

        <!-- ì‚¬ì´ë“œë°”: ë‹¨ì¼ VODì— ë§ì¶˜ íƒ­(ê°œìš”/ë©”ëª¨/ì±„íŒ…) -->
        <aside class="lr-sidebar" id="sidebar">
            <nav class="lr-tabs" role="tablist">
                <button class="active" data-tab="info" role="tab">ê°œìš”</button>
                <button data-tab="notes" role="tab">ë©”ëª¨</button>
                <button data-tab="chat" role="tab">ì±„íŒ…</button>
            </nav>

            <!-- âœ… ê°œìš” íƒ­: ë‹¨ì¼ ê°•ì˜ìš© ì‹¤ìš© ì¹´ë“œ -->
            <div class="lr-tabpanel" id="tab-info" role="tabpanel">
                <div class="lr-info-grid">
                    <!-- ìš”ì•½/ë©”íƒ€ -->
                    <div class="lr-card">
                        <h4>ê°•ì˜ ì •ë³´</h4>
                        <div class="lr-def">
                            <div class="row"><span class="k">ê°•ì˜ëª…</span><span th:text="${coursetitle}">ì œëª©</span></div>
                            <div class="row"><span class="k">ê°•ì‚¬</span><span th:text="${instructorName}">ê°•ì‚¬ëª…</span></div>
                            <div class="row"><span class="k">ì¬ìƒì‹œê°„</span><span id="metaDuration">-</span></div>
                            <div class="row"><span class="k">ì—…ë¡œë“œ</span><span th:text="${uploadedAt}">-</span></div>
                        </div>
                        <div class="lr-badges" style="margin-top:8px">
                            <span class="lr-badge">VOD</span>
                            <span class="lr-badge blue" th:if="${level != null}" th:text="${level}">Beginner</span>
                            <span class="lr-badge pink" th:if="${category != null}" th:text="${category}">Java</span>
                        </div>
                    </div>

                    <!-- ì§„í–‰/ì™„ë£Œ -->
                    <div class="lr-card">
                        <h4>ì§„í–‰ ìƒíƒœ</h4>
                        <div class="lr-def">
                            <div class="row"><span class="k">í˜„ì¬ ì§„í–‰</span><span id="percentNow">0%</span></div>
                            <div class="row"><span class="k">ìµœê·¼ ì‹œì²­ ìœ„ì¹˜</span><span id="lastPos">0:00</span></div>
                        </div>
                        <div class="lr-quick" style="margin-top:8px">
                            <button class="lr-ghost" type="button" onclick="markComplete()">ìˆ˜ê°•ì™„ë£Œ í‘œì‹œ</button>
                            <button class="lr-ghost" type="button" onclick="rewatchFromStart()">ì²˜ìŒë¶€í„° ë‹¤ì‹œë³´ê¸°</button>
                        </div>
                    </div>

                    <!-- ìë£Œ/ë§í¬ -->
                    <div class="lr-card">
                        <h4>ìë£Œ & ë§í¬</h4>
                        <div class="lr-resource">
                            <a th:if="${handoutUrl}" th:href="@{${handoutUrl}}" download>
                                <span>í•¸ë“œì•„ì›ƒ(PDF) ë‹¤ìš´ë¡œë“œ</span><span>â¬‡</span>
                            </a>
                            <a th:if="${refUrl}" th:href="@{${refUrl}}" target="_blank" rel="noopener">
                                <span>ì°¸ê³  ë§í¬ ì—´ê¸°</span><span>â†—</span>
                            </a>
                            <div th:if="${handoutUrl == null and refUrl == null}" class="lr-muted">ë“±ë¡ëœ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</div>
                        </div>
                    </div>

                    <!-- ë¹ ë¥¸ ì‘ì—… -->
                    <div class="lr-card">
                        <h4>ë¹ ë¥¸ ì‘ì—…</h4>
                        <div class="lr-quick">
                            <button class="lr-ghost" type="button" onclick="saveNote()">ë©”ëª¨ ì €ì¥</button>
                            <button class="lr-ghost" type="button" onclick="sendQuestion()">ì§ˆë¬¸ ë‚¨ê¸°ê¸°</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lr-tabpanel" id="tab-notes" role="tabpanel" hidden>
                <textarea id="note" class="lr-note" placeholder="ìˆ˜ê°• ì¤‘ ë©”ëª¨ë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”. (ë¸Œë¼ìš°ì €ì— ì„ì‹œ ì €ì¥)"></textarea>
                <div class="lr-note-actions">
                    <button class="lr-btn" type="button" onclick="saveNote()">ë©”ëª¨ ì €ì¥</button>
                    <button class="lr-ghost" type="button" onclick="clearNote()">ì§€ìš°ê¸°</button>
                </div>
            </div>

            <div class="lr-tabpanel" id="tab-chat" role="tabpanel" hidden>
                <div class="lr-chat" id="chatBox">
                    <div class="lr-chat-msg is-system">ì•ˆë…•í•˜ì„¸ìš”! ì§ˆë¬¸ì€ ì±„íŒ…ìœ¼ë¡œ ë‚¨ê²¨ì£¼ì„¸ìš”.</div>
                </div>
                <div class="lr-chat-input">
                    <input id="chatInput" type="text" placeholder="ë©”ì‹œì§€ ì…ë ¥">
                    <button class="lr-btn" type="button" onclick="sendChat()">ì „ì†¡</button>
                </div>
            </div>
        </aside>
    </main>

    <!-- í‘¸í„° íŒíŠ¸ -->
    <footer class="lr-footer">
        <div>ë‹¨ì¶•í‚¤: <kbd>Space</kbd> ì¬ìƒ/ì¼ì‹œì •ì§€ Â· <kbd>â†</kbd>/<kbd>â†’</kbd> 5ì´ˆ ì´ë™ Â· <kbd>F</kbd> ì „ì²´í™”ë©´</div>
    </footer>
</div>

<script th:inline="javascript">
    const v = document.getElementById('player');
    const progress = document.getElementById('progress');
    const cur = document.getElementById('currentTime');
    const dur = document.getElementById('duration');
    const speed = document.getElementById('speed');

    /* ì‹œê°„ í¬ë§· */
    const fmt = s => {
        if(!isFinite(s)) return '0:00';
        const m = Math.floor(s/60); const ss = Math.floor(s%60).toString().padStart(2,'0');
        return m + ':' + ss;
    };

    /* ë©”íƒ€ ì—…ë°ì´íŠ¸ */
    v.addEventListener('loadedmetadata', () => {
        dur.textContent = fmt(v.duration);
        const md = document.getElementById('metaDuration'); if (md) md.textContent = fmt(v.duration);
    });
    v.addEventListener('timeupdate', () => {
        cur.textContent = fmt(v.currentTime);
        progress.value = v.duration ? (v.currentTime / v.duration) * 100 : 0;
        // ì§„í–‰ë¥ /ìµœê·¼ ìœ„ì¹˜ ê°œìš” íŒ¨ë„ ë°˜ì˜
        const pct = document.getElementById('percentNow');
        const lp  = document.getElementById('lastPos');
        if (pct && v.duration) pct.textContent = Math.round((v.currentTime / v.duration) * 100) + '%';
        if (lp) lp.textContent = fmt(v.currentTime);
    });

    /* ìŠ¬ë¼ì´ë”ë¡œ íƒìƒ‰ */
    progress.addEventListener('input', () => {
        if(v.duration){
            v.currentTime = (progress.value / 100) * v.duration;
        }
    });

    /* ë°°ì† */
    speed.addEventListener('change', () => { v.playbackRate = parseFloat(speed.value); });

    /* ë‹¨ì¶•í‚¤ */
    document.addEventListener('keydown', (e) => {
        if(e.target.matches('input, textarea')) return;
        if(e.code === 'Space'){ e.preventDefault(); v.paused ? v.play() : v.pause(); }
        if(e.key === 'ArrowLeft') v.currentTime = Math.max(0, v.currentTime - 5);
        if(e.key === 'ArrowRight') v.currentTime = Math.min(v.duration||0, v.currentTime + 5);
        if(e.key.toLowerCase() === 'f') toggleFullscreen();
    });

    /* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */
    function step(sec){ v.currentTime = Math.min(Math.max(0, v.currentTime + sec), v.duration||0); }
    function toggleFullscreen(){
        const el = document.querySelector('.lr-player-wrap');
        if(document.fullscreenElement){ document.exitFullscreen(); }
        else { el.requestFullscreen?.(); }
    }

    /* ì‹œë„¤ë§ˆ ëª¨ë“œ/ì‚¬ì´ë“œë°” í† ê¸€ */
    function toggleTheater(){ document.body.classList.toggle('theater'); }
    function toggleSidebar(){ document.body.classList.toggle('sidebar-collapsed'); }

    /* íƒ­ */
    document.querySelectorAll('.lr-tabs button').forEach(btn=>{
        btn.addEventListener('click',()=>{
            document.querySelectorAll('.lr-tabs button').forEach(b=>b.classList.remove('active'));
            btn.classList.add('active');
            const tab = btn.dataset.tab;
            document.querySelectorAll('.lr-tabpanel').forEach(p=>p.hidden = true);
            document.getElementById('tab-' + tab).hidden = false;
        });
    });

    /* ë©”ëª¨ ë¡œì»¬ ë³´ê´€ */
    const note = document.getElementById('note');
    const noteKey = 'lr_note_' + (/*[[${courseId}]]*/ 0);
    function saveNote(){ localStorage.setItem(noteKey, note?.value || ''); alert('ë©”ëª¨ë¥¼ ì €ì¥í–ˆìŠµë‹ˆë‹¤.'); }
    function clearNote(){ if(!note) return; note.value = ''; localStorage.removeItem(noteKey); }
    if(note){ note.value = localStorage.getItem(noteKey) || ''; }

    /* ê°„ë‹¨ ì±„íŒ… (ë¡œì»¬ ë°ëª¨) */
    function sendChat(){
        const i = document.getElementById('chatInput'); if(!i || !i.value.trim()) return;
        const box = document.getElementById('chatBox');
        const div = document.createElement('div');
        div.className = 'lr-chat-msg';
        div.textContent = i.value.trim();
        box.appendChild(div);
        box.scrollTop = box.scrollHeight;
        i.value = '';
    }

    /* ê°œìš” íƒ­ ë¹ ë¥¸ ì‘ì—… */
    function markComplete(){
        // TODO: ì„œë²„ ì—°ë™ ì‹œ /api/progress/complete ê°™ì€ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
        alert('ìˆ˜ê°• ì™„ë£Œë¡œ í‘œì‹œí–ˆìŠµë‹ˆë‹¤.');
    }
    function rewatchFromStart(){ v.currentTime = 0; v.play?.(); }
    function sendQuestion(){
        // TODO: ë¬¸ì˜/ì§ˆë¬¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ê±°ë‚˜ ëª¨ë‹¬ ì—´ê¸°
        alert('ì§ˆë¬¸ ì‘ì„± í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        // location.href = '/board/qna/new?courseId=...';
    }

    // ğŸ”¹ ê°•ì˜ ì§„í–‰ë¥  ë¡œì»¬ ì €ì¥
    const courseId = /*[[${courseId}]]*/ 0;

    // 5ì´ˆë§ˆë‹¤ í˜„ì¬ ì§„í–‰ë¥  ì €ì¥
    setInterval(() => {
        if(v.duration){
            const percent = Math.round((v.currentTime / v.duration) * 100);
            localStorage.setItem(`progress_${courseId}`, percent);
        }
    }, 5000);

    // í˜ì´ì§€ ë‹«ì„ ë•Œë„ ì €ì¥
    window.addEventListener('beforeunload', () => {
        if(v.duration){
            const percent = Math.round((v.currentTime / v.duration) * 100);
            localStorage.setItem(`progress_${courseId}`, percent);
        }
    });


    /* ë…¸ì¶œ í•¨ìˆ˜ */
    window.sendChat = sendChat;
    window.step = step;
    window.toggleFullscreen = toggleFullscreen;
    window.toggleTheater = toggleTheater;
    window.toggleSidebar = toggleSidebar;
    window.saveNote = saveNote;
    window.clearNote = clearNote;
    window.markComplete = markComplete;
    window.rewatchFromStart = rewatchFromStart;
    window.sendQuestion = sendQuestion;
</script>
</body>
</html>
