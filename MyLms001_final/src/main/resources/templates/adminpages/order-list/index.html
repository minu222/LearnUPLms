<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>DW Academy</title>
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
            rel="stylesheet"
    />
    <link rel="stylesheet" th:href="@{/adminpages/css/style.css}">
    <link rel="stylesheet" th:href="@{/adminpages/css/menu.css}">
</head>

<body>
<div th:replace="adminpages/menu :: menu"></div>
    <main class="main">
        <div class="content-box">
            <h2>주문 목록</h2>

            <div class="search-box orders-search">
                <form th:action="@{/order/order-list}" method="get">
                    <input type="text" name="keyword" placeholder="주문번호(뒷자리)/이름" th:value="${keyword}">
                    <select name="status">
                        <option value="">전체</option>
                        <option value="paid" th:selected="${status == 'paid'}">결제완료</option>
                        <option value="refunded" th:selected="${status == 'refunded'}">환불</option>
                        <option value="pending" th:selected="${status == 'pending'}">대기중</option>
                    </select>
                    <button class="btn-primary" type="submit">검색</button>
                </form>
            </div>

            <table class="data-table table-gap-top orders-table" aria-label="주문 목록">
                <thead>
                <tr>
                    <th>주문번호</th>
                    <th>고객명</th>
                    <th>상품</th>
                    <th>금액</th>
                    <th>상태</th>
                </tr>
                </thead>
                <tbody>
                <!-- 주문 목록 반복 -->
                <tr th:each="order : ${orders}">
                    <td th:text="'O-' + ${#dates.format(order.createdAt, 'yyyyMMdd')} + '-' + ${order.orderId}"></td>
                    <td th:text="${order.userName}"></td>
                    <td th:text="${order.productName}"></td>
                    <td th:text="'₩' + ${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')}"></td>
                    <td>
            <span th:classappend="${order.status == 'paid'} ? 'badge done' :
                                   (${order.status == 'refunded'} ? 'badge refund' :
                                   (${order.status == 'pending'} ? 'badge pending' : 'badge'))"
                  th:text="${order.status == 'paid' ? '결제완료' :
                           (order.status == 'refunded' ? '환불' :
                           (order.status == 'pending' ? '대기중' : order.status))}">
              결제완료
            </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </main>
</div>
</body>
</html>
